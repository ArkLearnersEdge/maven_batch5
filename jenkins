pipeline
{
	agent any
	stages
	{
		stage('Continuous Download') 
		{
			steps
			{
				git 'https://github.com/ArkLearnersEdge/maven.git'
			}
			
		}
		stage('Continuous Build') 
		{
			steps
			{
				sh 'mvn package'
			}
		}
		stage('Continuous Deployment') 
		{
			steps
			{
				sh 'scp /home/ubuntu/.jenkins/workspace/descriptive_pipeline/webapp/target/webapp.war ubuntu@172.31.90.210:/var/lib/tomcat8/webapps/testapp'
			}
		}
		stage('Continuous Testing') 
		{
			steps
			{
				git 'https://github.com/ArkLearnersEdge/FunctionalTesting.git'
				sh 'java -jar /home/ubuntu/.jenkins/workspace/descriptive_pipeline/testing.jar'
			}
	    }
	}
	post
	{
		success
		{
			sh 'scp /home/ubuntu/.jenkins/workspace/descriptive_pipeline/webapp/target/webapp.war ubuntu@172.31.82.66:/var/lib/tomcat8/webapps/testapp'
		}
		failure
		{
			mail bcc: '', body: 'the processe has been failed plese recheck', cc: 'lalitha@gmail.com', from: '', replyTo: '', subject: 'CI-CD processes failed ', to: 'unis@gmail.com'
		}
	}	
}

